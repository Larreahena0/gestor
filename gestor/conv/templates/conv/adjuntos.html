{% extends 'core/base.html' %}

{% load auth_extras %}

{% block cuerpo %}

    <h1>Documentos Adjuntos</h1>
    <a class="config" title="Volver" alt="Volver" id="delete" href="{% url 'participar' %}"><i class="fas fa-reply"></i></a>
    <hr>
    <br>
    <div id="participantes">
        {% csrf_token %}
        {% if documentos.count != 0%}
            <table>
                <tr>
                {% if request.user|is_admin %}
                    <th>Documento de <br> la convocatoria </th>
                    <th>Tipo</th>
                {% elif request.user|is_coord %}
                    <th>Administrador <br> que revis√≥ la peticion </th>
                {% endif %}
                    <th>Documento <br> adjunto</th>
                    <th>Comentarios</th>
                    <th>Estado</th>
                    <th>Acciones</th>
                </tr>
                {% for documento in documentos %}
                    <tr>
                        {% if request.user|is_admin %}    
                            <td><a href="{{documento.id_documento.documento.url}}" download>{{documento.id_documento.description}}</a></td>
                            {% if documento.id_documento.tipo == 1 %}
                                <td>Informativo</td>
                            {% elif documento.id_documento.tipo == 2 %}   
                                <td>Opcional</td>
                            {% elif documento.id_documento.tipo == 3 %}   
                                <td>Obligatorio</td>    
                            {% endif %} 
                        {% elif request.user|is_coord %}
                            {% if documento.id_usuario %}
                                <td>{{documento.id_usuario.first_name}}<br>{{documento.id_usuario.last_name}}</td>
                            {% else %}    
                                <td>Ningun administrador<br>ha revisado el documento</td>
                            {% endif %}        
                        {% endif %}
                        <td><a id="a1" href="{{documento.documento.url}}" download>{{documento.documento}}</a></td>
                        <td>
                            {% if request.user|is_admin %}
                                {% if documento.comentarios%}
                                    <input type="text" name="comment_{{documento.id}}" id="comment_{{documento.id}}" placeholder="Comentarios del documento" autocomplete="off" value="{{documento.comentarios}}" required>
                                {% else %}
                                    <input type="text" name="comment_{{documento.id}}" id="comment_{{documento.id}}" placeholder="Comentarios del documento" autocomplete="off" required>
                                {% endif %}
                            {% elif request.user|is_coord %}
                                {% if documento.comentarios%}
                                    {{documento.comentarios}}
                                {% else %}    
                                    Sin comentarios
                                {% endif %}        
                            {% endif %}
                        </td>
                        <td>
                            {% if request.user|is_admin %}
                                <select name="state_{{documento.id}}" id="state_{{documento.id}}">
                                    <option disabled selected>Seleccione</option>
                                    {% if documento.estado == "1" %}
                                        <option value="1" selected>Aceptado</option>
                                        <option value="2">Rechazado</option>
                                    {% elif documento.estado == "2" %}   
                                        <option value="1">Aceptado</option>
                                        <option value="2" selected>Rechazado</option>
                                    {% elif documento.estado == "0" %}   
                                        <option value="1">Aceptado</option>
                                        <option value="2">Rechazado</option>
                                    {% endif %} 
                                </select>
                            {% elif request.user|is_coord %}
                                {% if documento.estado == "1" %}
                                    Aceptado
                                {% elif documento.estado == "2" %}   
                                    Rechazado
                                {% elif documento.estado == "0" %}   
                                    Sin revisar
                                {% endif %} 
                            {% endif %}
                            </td>
                        <td>
                            {% if request.user|is_admin %}
                                <a class="config2" title="Enviar" alt="Enviar" id="send" href="#" onclick="send({{documento.id}})"><i class="fab fa-telegram-plane"></i></a> 
                            {% elif request.user|is_coord %}
                                {% if documento.estado == "2" %}
                                    <a class="config2" title="Editar" alt="Editar" id="edit" href="#" onclick=""> <i class="fas fa-wrench"></i></a> 
                                {%else%}
                                    Sin Acciones
                                {% endif %}        
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}      
            </table>
        {% else %}
            <div class="message in-info">
                <p>En este momento no hay participantes.</p>
            </div>
        {% endif %}          
    </div>
    <br>

    {% load static %}
    <script type="text/javascript" src="{% static 'conv/js/script.js' %}"></script>
    <link rel="stylesheet" href="{% static 'conv/css/details_styles.css' %}">
{% endblock %}